<!DOCTYPE html>
<html lang="en">
    <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title> HTB - Bypass ‚Äî   | Gabriele Pongelli</title>
<meta name="description" content="This is the blog of Gabriele Pongelli.">
<meta name="keywords" content="">
<link rel="canonical" href="/posts/writeups/reverse%20engineering/htb-bypass">
    <link rel="stylesheet" href="/assets/css/github-markdown.css" type="text/css">
<link rel="stylesheet" href="/assets/css/github.css" type="text/css">
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha512-NhSC1YmyruXifcj/KFRWoC561YpHpc5Jtzgvbuzx5VozKpWvQ+4nXhPdFgmx8xqexRcpAglTj9sIBWINXa8x5w==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous">
<link href="https://fonts.googleapis.com/css?family=Quicksand" rel="stylesheet">
    </head>
    <body>
        <div class="wrapper">
        <header class="header">
    <div class="navigation">
        <a href="/" class="logo">Gabriele Pongelli</a>
        <ul class="menu">
            
            
            <li class="menu__entry"><a href="/">Home</a></li>
            
            <li class="menu__entry"><a href="/posts">Posts</a></li>
            
            <li class="menu__entry"><a href="/projects">Projects</a></li>
            
            <li class="menu__entry"><a href="/about">About</a></li>
            
        </ul>
    </div>
    <ul class="social-links">
    
    <a href="mailto:pongelligabriele@gmail.com" class="social-links__entry" target="_blank">
    <em class="fa fa-envelope-square"></em>
    </a>
    
    
    <a href="https://github.com/gabrielepongelli" class="social-links__entry" target="_blank">
    <em class="fab fa-github"></em>
    </a>
    
    
    <a href="https://in.linkedin.com/in/gabriele-p-68027a166" class="social-links__entry" target="_blank">
    <em class="fab fa-linkedin"></em>
    </a>
    
    </ul>
</header>
        <h1 class="page-title">
<div class="page-title__text">HTB - Bypass</div>
<div class="page-title__subtitle"></div>
</h1>

<div class="entry-content markdown-body">
<p>
    <strong class="post-meta">
        <time class="dt-published" datetime="2021-03-23T00:00:00+00:00" itemprop="datePublished">Mar 23, 2021
        </time></strong>
</p>

<div class="post-content e-content" itemprop="articleBody">
    <p id="fail" style="display: none;"> The flag is not correct, but don't worry I'll try my best anyway üí™üèª. Et voil√†: </p>
    <div id="secure-container" style="display: none;">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
QV/dGuNJ877XOMYLIUD9Q75E4XYANY8=</div>

    <div id="flag-input-box" style="display: block;">
        This writeup is protected. Please insert the flag to view this content.<br><br>
        <input id="flag" type="text" value="">
        <button id="decrypt-btn" onclick="tryDecryptPost()">Decrypt</button>
        <br><br><br>
    </div>
</div>
<a class="u-url" href="/posts/writeups/reverse%20engineering/htb-bypass" hidden></a>
<div id="decrypt_params">
<script>
let ivs = [];
ivs[0] = 'Osy2TDTfhxvmu1fnKPmfeQ==';
</script>
</div>
<script>
    let base64ToBytes = (b64) => {
        const binString = atob(b64);
        return Uint8Array.from(binString, (m) => m.codePointAt(0));
    }

    let deriveKey = async (flag) => {
        const flagBytes = new TextEncoder().encode(flag);
        return await window.crypto.subtle.digest("SHA-256", flagBytes);
    }

    let decrypt = async (rawKey, iv, data) => {
        const key = await window.crypto.subtle.importKey("raw", rawKey,
            "AES-CBC", false, ["decrypt",]);
        return await window.crypto.subtle.decrypt({ name: "AES-CBC", iv }, key, data);
    }

    let showPageContent = (content, fail = false) => {
        let secureContainerNode = document.getElementById("secure-container");
        secureContainerNode.innerHTML = content;
        secureContainerNode.style.display = "block";

        let flagInputBoxNode = document.getElementById("flag-input-box");
        flagInputBoxNode.style.display = "none";

        if (fail) {
            const failMsgNode = document.getElementById("fail");
            failMsgNode.style.display = "block";
        }
    }

    let showCorrectFlagContent = async (post, key) => {
        let postHTML = new DOMParser().parseFromString(post, "text/html").body;

        for (const [idx, iv] of ivs.slice(1).entries()) {
            const imageId = `secure-image-${idx}`;
            let imageTag = postHTML.querySelectorAll("#" + imageId)[0];
            try {
                const response = await fetch(imageTag.src);
                const encryptedImage = await response.arrayBuffer();
                const decryptedBytes = await decrypt(key, base64ToBytes(iv), encryptedImage);
                const objectURL = URL.createObjectURL(new Blob(
                    [decryptedBytes], { type: 'image/png' }));
                imageTag.src = objectURL;
            } catch (error) {
                console.error("An error occurred while decrypting the images inside this post: ", error);
            }
        }

        showPageContent(postHTML.innerHTML);
    }

    let showError = (post) => {
        showPageContent(JSON.stringify(post), true);
    }

    let modifyPageContent = async (flag) => {
        const encryptedPost = base64ToBytes(document
            .getElementById("secure-container").innerHTML);
        const iv = base64ToBytes(ivs[0]);
        const key = await deriveKey(flag);
        try {
            const decryptedBytes = await decrypt(key, iv, encryptedPost);
            const decryptedPost = new TextDecoder().decode(decryptedBytes);

            showCorrectFlagContent(decryptedPost, key);
        } catch (err) {
            showError(new TextDecoder().decode(encryptedPost));
        }
    }

    let tryDecryptPost = () => {
        const flag = document.getElementById("flag").value;
        modifyPageContent(flag);
    }
</script>
</div>
        </div>
        <footer class="about">
    <div class="about__devider">*****</div>
    <div class="about__text">
        üõ†Ô∏è Powered by Jekyll üõ†Ô∏è
        <br> üìñ Hosted on GitHub Pages üìñ
    </div>
</footer>
    </body>
</html>
