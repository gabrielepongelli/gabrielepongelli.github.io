<!DOCTYPE html>
<html lang="en">
    <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title> HTB - You know 0xDiablos ‚Äî   | Gabriele Pongelli</title>
<meta name="description" content="This is the blog of Gabriele Pongelli.">
<meta name="keywords" content="">
<link rel="canonical" href="/posts/writeups/pwn/htb-you-know-0xdiablos">
    <link rel="stylesheet" href="/assets/css/github-markdown.css" type="text/css">
<link rel="stylesheet" href="/assets/css/github.css" type="text/css">
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha512-NhSC1YmyruXifcj/KFRWoC561YpHpc5Jtzgvbuzx5VozKpWvQ+4nXhPdFgmx8xqexRcpAglTj9sIBWINXa8x5w==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous">
<link href="https://fonts.googleapis.com/css?family=Quicksand" rel="stylesheet">
    </head>
    <body>
        <div class="wrapper">
        <header class="header">
    <div class="navigation">
        <a href="/" class="logo">Gabriele Pongelli</a>
        <ul class="menu">
            
            
            <li class="menu__entry"><a href="/">Home</a></li>
            
            <li class="menu__entry"><a href="/posts">Posts</a></li>
            
            <li class="menu__entry"><a href="/projects">Projects</a></li>
            
            <li class="menu__entry"><a href="/about">About</a></li>
            
        </ul>
    </div>
    <ul class="social-links">
    
    <a href="mailto:pongelligabriele@gmail.com" class="social-links__entry" target="_blank">
    <em class="fa fa-envelope-square"></em>
    </a>
    
    
    <a href="https://github.com/gabrielepongelli" class="social-links__entry" target="_blank">
    <em class="fab fa-github"></em>
    </a>
    
    
    <a href="https://in.linkedin.com/in/gabriele-p-68027a166" class="social-links__entry" target="_blank">
    <em class="fab fa-linkedin"></em>
    </a>
    
    </ul>
</header>
        <h1 class="page-title">
<div class="page-title__text">HTB - You know 0xDiablos</div>
<div class="page-title__subtitle"></div>
</h1>

<div class="entry-content markdown-body">
<p>
    <strong class="post-meta">
        <time class="dt-published" datetime="2021-04-06T00:00:00+00:00" itemprop="datePublished">Apr 6, 2021
        </time></strong>
</p>

<div class="post-content e-content" itemprop="articleBody">
    <p id="fail" style="display: none;"> The flag is not correct, but don't worry I'll try my best anyway üí™üèª. Et voil√†: </p>
    <div id="secure-container" style="display: none;">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
WTIH4mD12/93QwN+J2SBr4g3pd+p3YsKCKbe</div>

    <div id="flag-input-box" style="display: block;">
        This writeup is protected. Please insert the flag to view this content.<br><br>
        <input id="flag" type="text" value="">
        <button id="decrypt-btn" onclick="tryDecryptPost()">Decrypt</button>
        <br><br><br>
    </div>
</div>
<a class="u-url" href="/posts/writeups/pwn/htb-you-know-0xdiablos" hidden></a>
<div id="decrypt_params">
<script>
let ivs = [];
ivs[0] = 'L/VpiWwipC5KeXkrdBfjUQ==';
</script>
</div>
<script>
    let base64ToBytes = (b64) => {
        const binString = atob(b64);
        return Uint8Array.from(binString, (m) => m.codePointAt(0));
    }

    let deriveKey = async (flag) => {
        const flagBytes = new TextEncoder().encode(flag);
        return await window.crypto.subtle.digest("SHA-256", flagBytes);
    }

    let decrypt = async (rawKey, iv, data) => {
        const key = await window.crypto.subtle.importKey("raw", rawKey,
            "AES-CBC", false, ["decrypt",]);
        return await window.crypto.subtle.decrypt({ name: "AES-CBC", iv }, key, data);
    }

    let showPageContent = (content, fail = false) => {
        let secureContainerNode = document.getElementById("secure-container");
        secureContainerNode.innerHTML = content;
        secureContainerNode.style.display = "block";

        let flagInputBoxNode = document.getElementById("flag-input-box");
        flagInputBoxNode.style.display = "none";

        if (fail) {
            const failMsgNode = document.getElementById("fail");
            failMsgNode.style.display = "block";
        }
    }

    let showCorrectFlagContent = async (post, key) => {
        let postHTML = new DOMParser().parseFromString(post, "text/html").body;

        for (const [idx, iv] of ivs.slice(1).entries()) {
            const imageId = `secure-image-${idx}`;
            let imageTag = postHTML.querySelectorAll("#" + imageId)[0];
            try {
                const response = await fetch(imageTag.src);
                const encryptedImage = await response.arrayBuffer();
                const decryptedBytes = await decrypt(key, base64ToBytes(iv), encryptedImage);
                const objectURL = URL.createObjectURL(new Blob(
                    [decryptedBytes], { type: 'image/png' }));
                imageTag.src = objectURL;
            } catch (error) {
                console.error("An error occurred while decrypting the images inside this post: ", error);
            }
        }

        showPageContent(postHTML.innerHTML);
    }

    let showError = (post) => {
        showPageContent(JSON.stringify(post), true);
    }

    let modifyPageContent = async (flag) => {
        const encryptedPost = base64ToBytes(document
            .getElementById("secure-container").innerHTML);
        const iv = base64ToBytes(ivs[0]);
        const key = await deriveKey(flag);
        try {
            const decryptedBytes = await decrypt(key, iv, encryptedPost);
            const decryptedPost = new TextDecoder().decode(decryptedBytes);

            showCorrectFlagContent(decryptedPost, key);
        } catch (err) {
            showError(new TextDecoder().decode(encryptedPost));
        }
    }

    let tryDecryptPost = () => {
        const flag = document.getElementById("flag").value;
        modifyPageContent(flag);
    }
</script>
</div>
        </div>
        <footer class="about">
    <div class="about__devider">*****</div>
    <div class="about__text">
        üõ†Ô∏è Powered by Jekyll üõ†Ô∏è
        <br> üìñ Hosted on GitHub Pages üìñ
    </div>
</footer>
    </body>
</html>
